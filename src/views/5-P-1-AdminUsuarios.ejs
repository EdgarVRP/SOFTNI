<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alta en sistema</title>
    <!-- Bootstrap 5.3 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
    />
    <!-- General CSS -->
    <link rel="stylesheet" href="./public/css/styles.css" />
    <link
      rel="icon"
      href="./public/imagenes/LogoCENIDET.jpg"
      type="image/x-icon"
    />
    <!-- Particular CSS -->
    <link rel="stylesheet" href="./public/css/5-P-1-AdminUsuarios.css" />
</head>

<body>
  <header>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-12 col-md-12 col-xl-12">
          <!-- Menu de hamburguesa -->
          <nav class="navbar fixed-top navbar-expand-md sticky-top">
            <div class="container-fluid">
              <img
                id="logo-navbar"
                src="./public/imagenes/LogoTecNM.jpg"
                alt="Logo TecNM"
                class="imgheader"
              />
              <button
                class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#pages"
                style="background-color: #ffffff"
              >
                <span
                  class="navbar-toggler-icon"
                  style="color: #ffffff"
                ></span>
              </button>

              <div class="row">
                <h1 class="text-center">SOFOM - Alta en sistema</h1>
                <div class="collapse navbar-collapse" id="pages">
                  <ul class="navbar-nav ms-auto">
                    <li id="nav-home" class="nav-item">
                      <a class="nav-link" href="./">Inicio</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./Analisis"
                        >Analisis de Crédito</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./Solicitud"
                        >Solicitud de crédito</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./Alta">Alta en sistema</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./indicadores"
                        >Indicadores</a
                      >
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="./Seguimiento">Seguimiento de crédito</a>
                    </li>
                    <!-- Se añade Admin que mostrara menu desplegable de Usuarios, Prestatarios y Proyectos -->
                    <li class="nav-item dropdown">
                      <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        id="navbarDropdown"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Admin
                      </a>
                      <ul
                        class="dropdown-menu"
                        aria-labelledby="navbarDropdown"
                      >
                        <li>
                          <a
                            id="nav-user"
                            class="dropdown-item"
                            href="./usuarios"
                            >Usuarios</a
                          >
                        </li>
                        <li>
                          <a
                            id="nav-user"
                            class="dropdown-item"
                            href="./prestatarios"
                            >Prestatarios</a
                          >
                        </li>
                        <li>
                          <a
                            id="nav-user"
                            class="dropdown-item"
                            href="./proyectos"
                            >Proyectos</a
                          >
                        </li>
                      </ul>
                      <!-- Se añade perfil que mostrara menu desplegable de ingresar y salir -->
                    </li>

                    <li class="nav-item dropdown">
                      <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        id="navbarDropdown"
                        role="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Perfil
                      </a>
                      <ul
                        class="dropdown-menu"
                        aria-labelledby="navbarDropdown"
                      >
                        <li>
                          <a
                            id="nav-user"
                            class="dropdown-item"
                            href="./login"
                            >Ingresar</a
                          >
                        </li>
                        <li>
                          <a
                            id="nav-user"
                            class="dropdown-item"
                            href="./logout"
                            >Salir</a
                          >
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
              <img
                id="logo-navbar"
                src="./public/imagenes/LogoCENIDET.jpg"
                alt="Logo"
                class="imgheader2"
              />
            </div>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- Tabla Usuarios  -->
  <div class="table-responsive">
  <table id="tablaUsuarios" class="table mt-4">
    <thead>
      <tr>
        <th style="display: none;">ID Mongo</th>
        <th>ID</th>
        <th>Nombre de usuario</th>
        <th>password</th>
        <th>Ultimo Acceso</th>
        <th>Rol</th>
        <th>Fecha de Creacion</th>
        <th>email</th>
        <th>telefono</th>
      </tr>
    </thead>
    <tbody>
      <% usuarios.forEach( (usuario)=> { %><tr>
          <td style="display: none;"><%= usuario._id %></td>
          <td><%=usuario.idUsuario%></td>
          <td><%=usuario.userName%></td>
          <td class="hidetext"><%=usuario.password%></td>
          <td><%=usuario.dateTimeLogin%></td>
          <td><%=usuario.rolUser%></td>
          <td><%=usuario.fechaCreacion%></td>
          <td><%=usuario.email%></td>
          <td><%=usuario.telefono%></td>
          <td>
            <a type="button" class="btnEditar btn btn-outline-primary bi bi-pencil"></a>
            <a href="/usuarios/borrar/<%= usuario._id %>" class="btn btn-outline-danger bi bi-trash"></a>
          </td>
        </tr>
        <% }) %>
    </tbody>
  </table>
</div>
  </div>

  <!-- Modal para Editar   -->
  <div id="modalUsuario" class="modal fade" tabindex="-1" aria-labelledby="modalUsuario" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="exampleModalLabel">Editar Info</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="formEditar">
            <input name="id_editar" id="id_editar" type="text" hidden>
            <div class="mb-3">
              <label for="idUsuario_editar" class="col-form-label" hidden>ID:</label>
              <input id="idUsuario_editar" name="idUsuario_editar" type="number" class="form-control" value="" hidden>
            </div>
            <div class="mb-3">
              <label for="userName_editar" class="col-form-label">Nombre de usuario:</label>
              <input id="userName_editar" name="userName_editar" type="text" class="form-control" value="">
            </div>
            <div class="mb-3">
              <label for="password_editar" class="col-form-label">Contraseña:</label>
              <input id="password_editar" name="password_editar" type="password" class="form-control" value="">
            </div>
            <input name="dateTimeLogin_editar" id="dateTimeLogin_editar" type="datetime" hidden>
            <div class="mb-3">
              <label for="rolUser_editar" class="col-form-label">Rol:</label>
              <select id="rolUser_editar" name="rolUser_editar">
                <option value="AdministradorTI">Administrador TI</option>
                <option value="PrestatarioSolicitante">Prestatario solicitante</option>
                <option value="EstructuradorCredito">Estructurador de crédito</option>
                <option value="DictaminadorCumplimientoLegal">Dictaminador de cumplimiento legal</option>
                <option value="DictaminadorDocumental">Dictaminador documental</option>
                <option value="AdministradorProyectos">Administrador de proyectos</option>
                <option value="DictaminadorTecnico">Dictaminador Técnico</option>
                <option value="Prestatario">Prestatario</option>
                <option value="GrupoInversionistas">Grupo de Inversionistas</option>
                <option value="Dirección">Dirección</option>
              </select>
            </div>
            <input name="fechaCreacion_editar" id="fechaCreacion_editar" type="datetime" hidden>
            <div class="mb-3">
              <label for="email_editar" class="col-form-label">email:</label>
              <input id="email_editar" name="email_editar" type="email" class="form-control" value="">
            </div>
            <div class="mb-3">
              <label for="Telefono_editar" class="col-form-label">Telefono:</label>
              <input id="Telefono_editar" name="Telefono_editar" type="number" class="form-control" value="">
            </div>


        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Actualizar</button>
        </div>
        </form>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="shadow-lg p-3 mb-5 bg-body rounded">
      <h4 class="col-md-6">Datos del nuevo usuario</h4>
      <form action="/usuarios/crear" method="POST">
        <div class="col-md-6" style="display: none">
          <label for="idUsuario" class="form-label">ID</label>
          <input id="idUsuario" name="idUsuario" type="number" class="form-control" required value=<%=lastid %>>
        </div>
        <div class="col-md-6">
          <label for="userName" class="form-label">Nombre de usuario</label>
          <input id="userName" name="userName" type="text" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label for="password" class="form-label">Contraseña</label>
          <input id="password" name="password" type="password" class="form-control" required>
        </div>
        <div class="col-md-6" style="display: none">
          <label for="dateTimeLogin" class="form-label">Ultimo login</label>
          <input id="dateTimeLogin" name="dateTimeLogin" type="datetime" class="form-control" required>
        </div>

        <!-- <div class="col-md-6">
          <label for="rolUser" class="form-label">Rol</label>
          <input id="rolUser" name="rolUser" type="text" class="form-control" required>
        </div> -->
        <Br>
        <div class="col-md-6">
          <label for="rolUser" class="form-label">Rol</label>
          <select id="rolUser" name="rolUser">
            <option value="AdministradorTI">Administrador TI</option>
            <option value="PrestatarioSolicitante">Prestatario solicitante</option>
            <option value="EstructuradorCredito">Estructurador de crédito</option>
            <option value="DictaminadorCumplimientoLegal">Dictaminador de cumplimiento legal</option>
            <option value="DictaminadorDocumental">Dictaminador documental</option>
            <option value="AdministradorProyectos">Administrador de proyectos</option>
            <option value="DictaminadorTecnico">Dictaminador Técnico</option>
            <option value="Prestatario">Prestatario</option>
            <option value="GrupoInversionistas">Grupo de Inversionistas</option>
            <option value="Dirección">Dirección</option>
          </select>
        </div>


        <div class="col-md-6" style="display: none">
          <label for="fechaCreacion" class="form-label">Fecha de Creacion</label>
          <input id="fechaCreacion" name="fechaCreacion" type="datetime" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">email</label>
          <input id="email" name="email" type="email" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label for="telefono" class="form-label">Telefono</label>
          <input id="telefono" name="telefono" type="number" class="form-control" required>
        </div>
    </div>

  </div>
  <div class="botonRegistrar">
    <button type="submit" class="btn btn-guardar btn-lg "><i class="bi bi-save"></i>Registrar Usuario</button>
  </div>
  <footer>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-12 col-md-12 col-xl-12 text-center">
          <div class="footerNav">
          <a href="./contacto">
            <p >Contacto</p>
          </a>
          <a href="https://github.com/EdgarVRP">
            <p class="Copyright">SOFTNI&copy By EdgarVRP</p>
          </a>
        </div>
          <!-- Button trigger modal -->
          <button
            type="button"
            class="btn btn-guardar btn-lg"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
          >
            Aviso de Privacidad
          </button>

          <!-- Modal -->
          <div
            class="modal fade"
            id="exampleModal"
            tabindex="-1"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                  <h5 class="modal-title" id="exampleModalLabel">
                    Aviso de Privacidad
                  </h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <label for="userName_editar" class="col-form-label">
                    POLÍTICA DE COOKIES El acceso a este Sitio Web puede
                    implicar la utilización de cookies. Las cookies son
                    pequeñas cantidades de información que se almacenan en el
                    navegador utilizado por cada Usuario —en los distintos
                    dispositivos que pueda utilizar para navegar— para que el
                    servidor recuerde cierta información que posteriormente y
                    únicamente el servidor que la implementó leerá. Las
                    cookies facilitan la navegación, la hacen más amigable, y
                    no dañan el dispositivo de navegación. Las cookies son
                    procedimientos automáticos de recogida de información
                    relativa a las preferencias determinadas por el Usuario
                    durante su visita al Sitio Web con el fin de reconocerlo
                    como Usuario, y personalizar su experiencia y el uso del
                    Sitio Web, y pueden también, por ejemplo, ayudar a
                    identificar y resolver errores. La información recabada a
                    través de las cookies puede incluir la fecha y hora de
                    visitas al Sitio Web, las páginas visionadas, el tiempo
                    que ha estado en el Sitio Web y los sitios visitados justo
                    antes y después del mismo. Sin embargo, ninguna cookie
                    permite que esta misma pueda contactarse con el número de
                    teléfono del Usuario o con cualquier otro medio de
                    contacto personal. Ninguna cookie puede extraer
                    información del disco duro del Usuario o robar información
                    personal. La única manera de que la información privada
                    del Usuario forme parte del archivo Cookie es que el
                    usuario dé personalmente esa información al servidor. Las
                    cookies que permiten identificar a una persona se
                    consideran datos personales. Por tanto, a las mismas les
                    será de aplicación la Política de Privacidad anteriormente
                    descrita. En este sentido, para la utilización de las
                    mismas será necesario el consentimiento del Usuario. Este
                    consentimiento será comunicado, en base a una elección
                    auténtica, ofrecido mediante una decisión afirmativa y
                    positiva, antes del tratamiento inicial, removible y
                    documentado. Cookies propias Son aquellas cookies que son
                    enviadas al ordenador o dispositivo del Usuario y
                    gestionadas exclusivamente por SOFOM CENIDET para el mejor
                    funcionamiento del Sitio Web. La información que se recaba
                    se emplea para mejorar la calidad del Sitio Web y su
                    Contenido y su experiencia como Usuario. Estas cookies
                    permiten reconocer al Usuario como visitante recurrente
                    del Sitio Web y adaptar el contenido para ofrecerle
                    contenidos que se ajusten a sus preferencias.
                    Deshabilitar, rechazar y eliminar cookies El Usuario puede
                    deshabilitar, rechazar y eliminar las cookies —total o
                    parcialmente— instaladas en su dispositivo mediante la
                    configuración de su navegador (entre los que se
                    encuentran, por ejemplo, Chrome, Firefox, Safari,
                    Explorer). En este sentido, los procedimientos para
                    rechazar y eliminar las cookies pueden diferir de un
                    navegador de Internet a otro. En consecuencia, el Usuario
                    debe acudir a las instrucciones facilitadas por el propio
                    navegador de Internet que esté utilizando. En el supuesto
                    de que rechace el uso de cookies —total o parcialmente—
                    podrá seguir usando el Sitio Web, si bien podrá tener
                    limitada la utilización de algunas de las prestaciones del
                    mismo. Este documento de Política de Cookies ha sido
                    creado mediante el generador de plantilla de política de
                    cookies online el día 27/11/2022.
                  </label>
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Cerrar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- Script Bootstrap 5.3 -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"
  ></script>
  <!-- Script General -->
  <script src="./public/js/script.js"></script>
  <script src="./public/js/5-P-1-AdminUsuarios.js"></script>
</body>

</html>